<% if (_.find(databases, { name: 'mongo'})) { %>
{{/*
Calculate mongo_url
*/}}
{{- define "<%- name %>.mongo_url" }}
{{- $mongo := .Values.config.mongo }}
{{- if $mongo.internal }}
{{- printf "mongodb://%s-mongo:27017/%s" (include "<%- name %>.fullname" . ) $mongo.database }}
{{- else }}
{{- if $mongo.url }}
{{- printf $mongo.url }}
{{- else }}
{{- $credentials := (empty $mongo.username | ternary "" (printf "%s:%s" $mongo.username $mongo.password)) }}
{{- printf "mongodb://%s@%s:%s/%s" $credentials $mongo.host $mongo.port $mongo.database }}
{{- end }}
{{- end }}
{{- end }}<% } %>